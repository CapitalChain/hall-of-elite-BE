generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Mt5Trader {
  id            String               @id @default(uuid())
  externalId    String               @unique
  name          String
  accountStatus String
  createdAt     DateTime             @default(now())
  updatedAt     DateTime             @updatedAt
  accounts      Mt5TradingAccount[]
  metrics       Mt5TraderMetrics[]

  @@map("mt5_traders")
}

model Mt5TradingAccount {
  id         String     @id @default(uuid())
  traderId   String
  externalId String     @unique
  balance    Float
  leverage   Int
  currency   String
  status     String
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  trader     Mt5Trader  @relation(fields: [traderId], references: [id], onDelete: Cascade)
  trades     Mt5Trade[]

  @@index([traderId])
  @@map("mt5_trading_accounts")
}

model Mt5Trade {
  id         String            @id @default(uuid())
  externalId String            @unique
  accountId  String
  symbol     String
  volume     Float
  profitLoss Float
  fees       Float
  openTime   DateTime
  closeTime  DateTime?
  status     String
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  account    Mt5TradingAccount @relation(fields: [accountId], references: [id], onDelete: Cascade)

  @@index([accountId])
  @@map("mt5_trades")
}

model Mt5TraderMetrics {
  id               String    @id @default(uuid())
  traderId         String    @unique
  profitFactor     Float
  winRate          Float
  drawdown         Float
  totalTradingDays Int
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  trader           Mt5Trader @relation(fields: [traderId], references: [id], onDelete: Cascade)

  @@index([traderId])
  @@map("mt5_trader_metrics")
}
